{"version":3,"sources":["webpack:///static/js/2.f3df060b39de9988368f.js","webpack:///./src/views/Message.vue","webpack:///Message.vue","webpack:///./src/views/Message.vue?7a08"],"names":["webpackJsonp","242","module","exports","__webpack_require__","Component","249","__webpack_exports__","Object","defineProperty","value","data","tab","displayList","activated","this","$store","commit","onFetchMessage","computed","minHeight","document","body","clientHeight","window","screen","height","isShowTip","length","methods","onSwitchTab","_this","checkLogin","$axios","get","params","accesstoken","getters","accessToken","then","result","console","log","hasnot_read_messages","has_read_messages","catch","e","$vux","toast","show","text","onClickMessage","id","_this2","post","$router","push","name","query","replace","255","render","_vm","_h","$createElement","_c","_self","staticClass","style","attrs","selected","nativeOn","click","$event","_v","_l","i","on","topic","src","author","avatar_url","alt","_s","loginname","_f","create_at","domProps","innerHTML","reply","content","title","directives","rawName","expression","_m","staticRenderFns"],"mappings":"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","file":"static/js/2.f3df060b39de9988368f.js","sourcesContent":["webpackJsonp([2,8],{\n\n/***/ 242:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(0)(\n  /* script */\n  __webpack_require__(249),\n  /* template */\n  __webpack_require__(255),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 249:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = {\n  data: function data() {\n    return {\n      tab: 0,\n      displayList: []\n    };\n  },\n  activated: function activated() {\n    this.$store.commit('SET_SHOWTABBAR', true);\n    this.onFetchMessage();\n  },\n\n  computed: {\n    minHeight: function minHeight() {\n      return document.body.clientHeight >= 400 && document.body.clientHeight <= 736 ? document.body.clientHeight : window.screen.height;\n    },\n    isShowTip: function isShowTip() {\n      return !(this.displayList && this.displayList.length);\n    }\n  },\n  methods: {\n    onSwitchTab: function onSwitchTab(tab) {\n      this.tab = tab;\n      this.onFetchMessage();\n    },\n    onFetchMessage: function onFetchMessage() {\n      var _this = this;\n\n      if (this.checkLogin()) {\n        this.$axios.get('/messages', {\n          params: {\n            accesstoken: this.$store.getters.accessToken\n          }\n        }).then(function (result) {\n          console.log(result);\n          _this.displayList = _this.tab === 0 ? result.data.data.hasnot_read_messages : result.data.data.has_read_messages;\n        }).catch(function (e) {\n          console.log(e);\n          _this.$vux.toast.show({\n            text: '获取消息失败'\n          });\n        });\n      }\n    },\n    onClickMessage: function onClickMessage(id) {\n      var _this2 = this;\n\n      this.$axios.post('/message/mark_all', {\n        accesstoken: this.$store.getters.accessToken\n      }).then(function (result) {\n        console.log(result);\n      }).catch(function (e) {\n        console.log(e);\n        _this2.$vux.toast.show({\n          text: '标记全部已读失败'\n        });\n      });\n      this.$router.push({\n        name: 'detail',\n        query: {\n          id: id\n        }\n      });\n    },\n    checkLogin: function checkLogin() {\n      var accessToken = this.$store.getters.accessToken;\n      if (!accessToken) {\n        this.$vux.toast.show({\n          text: '请先登录'\n        });\n        this.$router.replace('/login');\n        return false;\n      } else {\n        return true;\n      }\n    }\n  }\n};\n\n/***/ }),\n\n/***/ 255:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"message-box\",\n    style: ({\n      minHeight: _vm.minHeight - 50 + 'px'\n    })\n  }, [_c('tab', [_c('tab-item', {\n    attrs: {\n      \"selected\": \"\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.onSwitchTab(0)\n      }\n    }\n  }, [_vm._v(\"未读消息\")]), _vm._v(\" \"), _c('tab-item', {\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.onSwitchTab(1)\n      }\n    }\n  }, [_vm._v(\"已读消息\")])], 1), _vm._v(\" \"), _vm._l((_vm.displayList), function(i) {\n    return _c('div', {\n      staticClass: \"message-li\",\n      on: {\n        \"click\": function($event) {\n          _vm.onClickMessage(i.topic.id)\n        }\n      }\n    }, [_c('div', {\n      staticClass: \"message-head\"\n    }, [_c('div', {\n      staticClass: \"avatar\"\n    }, [_c('img', {\n      attrs: {\n        \"src\": i.author.avatar_url,\n        \"alt\": \"headImgUrl\"\n      }\n    })]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-head-right\"\n    }, [_c('div', {\n      staticClass: \"message-name\"\n    }, [_vm._v(\"\\n          \" + _vm._s(i.author.loginname) + \"\\n          \"), _c('span', [_vm._v(_vm._s(_vm._f(\"timeAgo\")(i.create_at)))])]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-intro\"\n    }, [_vm._v(\"\\n          回复了您的话题\\n        \")])])]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-content\",\n      domProps: {\n        \"innerHTML\": _vm._s(i.reply.content)\n      }\n    }), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-topic\"\n    }, [_vm._v(\"\\n      话题：\" + _vm._s(i.topic.title) + \"\\n    \")])])\n  }), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.isShowTip),\n      expression: \"isShowTip\"\n    }],\n    staticClass: \"message-tip\",\n    style: ({\n      minHeight: (_vm.minHeight - 100) + 'px'\n    })\n  }, [_vm._m(0), _vm._v(\" \"), _c('div', {\n    staticClass: \"message-text\"\n  }, [_vm._v(\"\\n      暂无消息\\n    \")])])], 2)\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"message-icon\"\n  }, [_c('i', {\n    staticClass: \"icon-comment-alt\"\n  })])\n}]}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/2.f3df060b39de9988368f.js","var Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Message.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-6ce6e41a!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Message.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/Message.vue\n// module id = 242\n// module chunks = 2","<template>\n  <div class=\"message-box\" :style=\"{minHeight: minHeight - 50 + 'px'}\">\n    <tab>\n      <tab-item selected @click.native=\"onSwitchTab(0)\">未读消息</tab-item>\n      <tab-item @click.native=\"onSwitchTab(1)\">已读消息</tab-item>\n    </tab>\n    <div class=\"message-li\" v-for=\"i in displayList\" @click=\"onClickMessage(i.topic.id)\">\n      <div class=\"message-head\">\n        <div class=\"avatar\">\n          <img :src=\"i.author.avatar_url\" alt=\"headImgUrl\">\n        </div>\n        <div class=\"message-head-right\">\n          <div class=\"message-name\">\n            {{i.author.loginname}}\n            <span>{{i.create_at | timeAgo}}</span>\n          </div>\n          <div class=\"message-intro\">\n            回复了您的话题\n          </div>\n        </div>\n      </div>\n      <div class=\"message-content\" v-html=\"i.reply.content\">\n\n      </div>\n      <div class=\"message-topic\">\n        话题：{{i.topic.title}}\n      </div>\n    </div>\n    <div class=\"message-tip\" :style=\"{minHeight: (minHeight - 100) + 'px'}\" v-show=\"isShowTip\">\n      <div class=\"message-icon\">\n        <i class=\"icon-comment-alt\"></i>\n      </div>\n      <div class=\"message-text\">\n        暂无消息\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  export default {\n    data () {\n      return {\n        tab: 0,\n        displayList: [],\n      }\n    },\n    activated(){\n      this.$store.commit('SET_SHOWTABBAR', true)\n      this.onFetchMessage()\n    },\n    computed: {\n      minHeight: () => {\n        return (document.body.clientHeight >= 400 && document.body.clientHeight <= 736) ? document.body.clientHeight : window.screen.height\n      },\n      isShowTip: function() {\n        return !(this.displayList && this.displayList.length)\n      }\n    },\n    methods: {\n      onSwitchTab(tab){\n        this.tab = tab\n        this.onFetchMessage()\n      },\n      onFetchMessage(){\n        if (this.checkLogin()) {\n          this.$axios.get(`/messages`, {\n            params: {\n              accesstoken: this.$store.getters.accessToken,\n            }\n          })\n            .then(result => {\n              console.log(result)\n              this.displayList = this.tab === 0 ? result.data.data.hasnot_read_messages : result.data.data.has_read_messages\n            })\n            .catch(e => {\n              console.log(e)\n              this.$vux.toast.show({\n                text: '获取消息失败',\n              })\n            })\n        }\n      },\n      onClickMessage(id){\n        this.$axios.post(`/message/mark_all`, {\n          accesstoken: this.$store.getters.accessToken,\n        })\n          .then(result => {\n            console.log(result)\n          })\n          .catch(e => {\n            console.log(e)\n            this.$vux.toast.show({\n              text: '标记全部已读失败',\n            })\n          })\n        this.$router.push({\n          name: 'detail',\n          query: {\n            id: id\n          }\n        })\n      },\n      checkLogin(){\n        let accessToken = this.$store.getters.accessToken\n        if (!accessToken) {\n          this.$vux.toast.show({\n            text: '请先登录',\n          })\n          this.$router.replace('/login')\n          return false\n        } else {\n          return true\n        }\n      },\n    }\n  }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// Message.vue?4d42a76f","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"message-box\",\n    style: ({\n      minHeight: _vm.minHeight - 50 + 'px'\n    })\n  }, [_c('tab', [_c('tab-item', {\n    attrs: {\n      \"selected\": \"\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.onSwitchTab(0)\n      }\n    }\n  }, [_vm._v(\"未读消息\")]), _vm._v(\" \"), _c('tab-item', {\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.onSwitchTab(1)\n      }\n    }\n  }, [_vm._v(\"已读消息\")])], 1), _vm._v(\" \"), _vm._l((_vm.displayList), function(i) {\n    return _c('div', {\n      staticClass: \"message-li\",\n      on: {\n        \"click\": function($event) {\n          _vm.onClickMessage(i.topic.id)\n        }\n      }\n    }, [_c('div', {\n      staticClass: \"message-head\"\n    }, [_c('div', {\n      staticClass: \"avatar\"\n    }, [_c('img', {\n      attrs: {\n        \"src\": i.author.avatar_url,\n        \"alt\": \"headImgUrl\"\n      }\n    })]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-head-right\"\n    }, [_c('div', {\n      staticClass: \"message-name\"\n    }, [_vm._v(\"\\n          \" + _vm._s(i.author.loginname) + \"\\n          \"), _c('span', [_vm._v(_vm._s(_vm._f(\"timeAgo\")(i.create_at)))])]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-intro\"\n    }, [_vm._v(\"\\n          回复了您的话题\\n        \")])])]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-content\",\n      domProps: {\n        \"innerHTML\": _vm._s(i.reply.content)\n      }\n    }), _vm._v(\" \"), _c('div', {\n      staticClass: \"message-topic\"\n    }, [_vm._v(\"\\n      话题：\" + _vm._s(i.topic.title) + \"\\n    \")])])\n  }), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.isShowTip),\n      expression: \"isShowTip\"\n    }],\n    staticClass: \"message-tip\",\n    style: ({\n      minHeight: (_vm.minHeight - 100) + 'px'\n    })\n  }, [_vm._m(0), _vm._v(\" \"), _c('div', {\n    staticClass: \"message-text\"\n  }, [_vm._v(\"\\n      暂无消息\\n    \")])])], 2)\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"message-icon\"\n  }, [_c('i', {\n    staticClass: \"icon-comment-alt\"\n  })])\n}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-6ce6e41a!./~/vue-loader/lib/selector.js?type=template&index=0!./src/views/Message.vue\n// module id = 255\n// module chunks = 2"],"sourceRoot":""}